{% extends "site/full_screen_site_page.html" %}

{% load static %}
{% load i18n %}

{% block site_page_styles %}
<link rel="stylesheet" media="screen" type="text/css"
      href="{% get_static_prefix %}site/css/index.css"/>
{% endblock site_page_styles %}

{% block site_page %}

<div id="index-block" ng-app="myApp" ng-controller="mainPageViewCtrl" ng-init="problemViewURL='{% url 'site_problem_view' %}'; loadDataURL='{% url 'site_get_main_page_markers' %}'; latitude='{{ center.latitude }}'; longitude='{{ center.longitude }}'; zoom='{{ center.zoom }}'; map_init();">
    {% verbatim %}
        <alert ng-repeat="alert in alerts" type="alert.type" close="closeAlert($index)">{{alert.msg}}</alert>
    {% endverbatim %}

    <!-- Side Menu -->
    <a ng-click="showMenu=!showMenu;" ng-class="{inactive: showMenu}" id="menu-toggle" href="#" class="btn btn-primary btn-xs toggle"><i class="fa fa-caret-square-o-left"></i></a>
    <div id="sidebar-wrapper" ng-class="showMenu ? 'active' : 'inactive'">
        <ul class="sidebar-nav">
            <a ng-click="showMenu=!showMenu;" id="menu-close" href="#" class="btn btn-default btn-xs pull-right toggle"><i class="fa fa-times"></i></a>
            <li class="sidebar-brand">
                {% trans 'Menu' %}
            </li>
            <li ng-class="{active: reportBy=='all'}">
                <a href="" ng-click="reportBy='all';">{% trans 'All Problems' %}</a>
            </li>
            <li ng-class="{active: reportBy=='me'}">
                <a href="" ng-click="reportBy='me';">{% trans 'Reported by me' %}</a>
            </li>
            <li>
                <a href="{% url 'site_create_problem' %}">{% trans 'Report new problem' %}</a>
            </li>
        </ul>
    </div>
    <!-- /Side Menu -->

    <div id="content">
        <div class="paddedContent">
            <div id="map_canvas" style="width: 100%; height: 100%;"></div>
        </div>
    </div>

</div>


{% endblock site_page %}

{% block site_page_scripts %}
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>
    <script src="{% get_static_prefix %}libs/angular/ui-bootstrap-tpls-0.10.0.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular-cookies.min.js"></script>
    <script>
        var app = angular.module("myApp", ["ui.bootstrap", "ngCookies"]);
        app.run(['$http','$cookies',function($http, $cookies)
        {
            $http.defaults.headers.post['X-CSRFToken'] = $cookies.csrftoken;
        }]);
    </script>
    <script type="text/javascript" src="{% get_static_prefix %}site/js/index.js"></script>
{% endblock site_page_scripts %}
